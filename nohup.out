Looking in indexes: http://mirrors.aliyun.com/pypi/simple/, https://pypi.ngc.nvidia.com
Requirement already satisfied: wandb in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 1)) (0.15.4)
Requirement already satisfied: tensorboard in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 2)) (2.11.2)
Requirement already satisfied: diffusers in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 4)) (0.17.1)
Requirement already satisfied: timm in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 5)) (0.9.2)
Requirement already satisfied: pyyaml in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 7)) (6.0)
Requirement already satisfied: scipy in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 8)) (1.7.3)
Requirement already satisfied: termcolor in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 9)) (2.3.0)
Requirement already satisfied: yacs in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 10)) (0.1.8)
Requirement already satisfied: accelerate in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from -r requirements.txt (line 11)) (0.20.3)
Requirement already satisfied: pathtools in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (0.1.2)
Requirement already satisfied: setproctitle in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (1.3.2)
Requirement already satisfied: Click!=8.0.0,>=7.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (8.1.3)
Requirement already satisfied: sentry-sdk>=1.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (1.27.0)
Requirement already satisfied: typing-extensions in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (4.7.1)
Requirement already satisfied: requests<3,>=2.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (2.31.0)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (3.1.31)
Requirement already satisfied: psutil>=5.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (5.9.5)
Requirement already satisfied: docker-pycreds>=0.4.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (0.4.0)
Requirement already satisfied: appdirs>=1.4.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (1.4.4)
Requirement already satisfied: setuptools in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (65.6.3)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.12.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->-r requirements.txt (line 1)) (3.20.3)
Requirement already satisfied: google-auth<3,>=1.6.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (2.21.0)
Requirement already satisfied: grpcio>=1.24.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (1.56.0)
Requirement already satisfied: absl-py>=0.4 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (1.4.0)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (0.4.6)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (0.6.1)
Requirement already satisfied: numpy>=1.12.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (1.21.6)
Requirement already satisfied: werkzeug>=1.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (2.2.3)
Requirement already satisfied: wheel>=0.26 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (0.38.4)
Requirement already satisfied: markdown>=2.6.8 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (3.4.3)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->-r requirements.txt (line 2)) (1.8.1)
Requirement already satisfied: filelock in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from diffusers->-r requirements.txt (line 4)) (3.12.2)
Requirement already satisfied: Pillow in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from diffusers->-r requirements.txt (line 4)) (9.5.0)
Requirement already satisfied: importlib-metadata in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from diffusers->-r requirements.txt (line 4)) (6.7.0)
Requirement already satisfied: regex!=2019.12.17 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from diffusers->-r requirements.txt (line 4)) (2023.6.3)
Requirement already satisfied: huggingface-hub>=0.13.2 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from diffusers->-r requirements.txt (line 4)) (0.16.2)
Requirement already satisfied: safetensors in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->-r requirements.txt (line 5)) (0.3.1)
Requirement already satisfied: torchvision in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->-r requirements.txt (line 5)) (0.14.1)
Requirement already satisfied: torch>=1.7 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->-r requirements.txt (line 5)) (1.13.1)
Requirement already satisfied: packaging>=20.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from accelerate->-r requirements.txt (line 11)) (23.1)
Requirement already satisfied: six>=1.4.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from docker-pycreds>=0.4.0->wandb->-r requirements.txt (line 1)) (1.16.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 1)) (4.0.10)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 2)) (5.3.1)
Requirement already satisfied: urllib3<2.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 2)) (1.26.16)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 2)) (0.3.0)
Requirement already satisfied: rsa<5,>=3.1.4 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 2)) (4.9)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 2)) (1.3.1)
Requirement already satisfied: tqdm>=4.42.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from huggingface-hub>=0.13.2->diffusers->-r requirements.txt (line 4)) (4.65.0)
Requirement already satisfied: fsspec in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from huggingface-hub>=0.13.2->diffusers->-r requirements.txt (line 4)) (2023.1.0)
Requirement already satisfied: zipp>=0.5 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from importlib-metadata->diffusers->-r requirements.txt (line 4)) (3.15.0)
Requirement already satisfied: idna<4,>=2.5 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb->-r requirements.txt (line 1)) (3.4)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb->-r requirements.txt (line 1)) (3.1.0)
Requirement already satisfied: certifi>=2017.4.17 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb->-r requirements.txt (line 1)) (2022.12.7)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch>=1.7->timm->-r requirements.txt (line 5)) (11.7.99)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch>=1.7->timm->-r requirements.txt (line 5)) (11.10.3.66)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch>=1.7->timm->-r requirements.txt (line 5)) (8.5.0.96)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch>=1.7->timm->-r requirements.txt (line 5)) (11.7.99)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from werkzeug>=1.0.1->tensorboard->-r requirements.txt (line 2)) (2.1.3)
Requirement already satisfied: smmap<6,>=3.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 1)) (5.0.0)
Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 2)) (0.5.0)
Requirement already satisfied: oauthlib>=3.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 2)) (3.2.2)
Looking in indexes: http://mirrors.aliyun.com/pypi/simple/, https://pypi.ngc.nvidia.com
Obtaining file:///data/students/liuzhou/projects/Min-snr-diffusion-2
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: blobfile>=1.0.5 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (2.0.2)
Requirement already satisfied: torch in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (1.13.1)
Requirement already satisfied: tqdm in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (4.65.0)
Requirement already satisfied: wandb in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (0.15.4)
Requirement already satisfied: tensorboard in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (2.11.2)
Requirement already satisfied: timm in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from guided-diffusion==0.0.0) (0.9.2)
Requirement already satisfied: pycryptodomex~=3.8 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from blobfile>=1.0.5->guided-diffusion==0.0.0) (3.18.0)
Requirement already satisfied: urllib3<3,>=1.25.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from blobfile>=1.0.5->guided-diffusion==0.0.0) (1.26.16)
Requirement already satisfied: filelock~=3.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from blobfile>=1.0.5->guided-diffusion==0.0.0) (3.12.2)
Requirement already satisfied: lxml~=4.9 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from blobfile>=1.0.5->guided-diffusion==0.0.0) (4.9.3)
Requirement already satisfied: requests<3,>=2.21.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (2.31.0)
Requirement already satisfied: werkzeug>=1.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (2.2.3)
Requirement already satisfied: numpy>=1.12.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (1.21.6)
Requirement already satisfied: absl-py>=0.4 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (1.4.0)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (0.4.6)
Requirement already satisfied: setuptools>=41.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (65.6.3)
Requirement already satisfied: markdown>=2.6.8 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (3.4.3)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (1.8.1)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (0.6.1)
Requirement already satisfied: wheel>=0.26 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (0.38.4)
Requirement already satisfied: google-auth<3,>=1.6.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (2.21.0)
Requirement already satisfied: grpcio>=1.24.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (1.56.0)
Requirement already satisfied: protobuf<4,>=3.9.2 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from tensorboard->guided-diffusion==0.0.0) (3.20.3)
Requirement already satisfied: torchvision in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->guided-diffusion==0.0.0) (0.14.1)
Requirement already satisfied: safetensors in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->guided-diffusion==0.0.0) (0.3.1)
Requirement already satisfied: huggingface-hub in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->guided-diffusion==0.0.0) (0.16.2)
Requirement already satisfied: pyyaml in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from timm->guided-diffusion==0.0.0) (6.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch->guided-diffusion==0.0.0) (11.7.99)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch->guided-diffusion==0.0.0) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch->guided-diffusion==0.0.0) (11.10.3.66)
Requirement already satisfied: typing-extensions in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch->guided-diffusion==0.0.0) (4.7.1)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torch->guided-diffusion==0.0.0) (11.7.99)
Requirement already satisfied: psutil>=5.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (5.9.5)
Requirement already satisfied: docker-pycreds>=0.4.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (0.4.0)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (3.1.31)
Requirement already satisfied: sentry-sdk>=1.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (1.27.0)
Requirement already satisfied: Click!=8.0.0,>=7.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (8.1.3)
Requirement already satisfied: appdirs>=1.4.3 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (1.4.4)
Requirement already satisfied: setproctitle in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (1.3.2)
Requirement already satisfied: pathtools in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from wandb->guided-diffusion==0.0.0) (0.1.2)
Requirement already satisfied: importlib-metadata in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from Click!=8.0.0,>=7.0->wandb->guided-diffusion==0.0.0) (6.7.0)
Requirement already satisfied: six>=1.4.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from docker-pycreds>=0.4.0->wandb->guided-diffusion==0.0.0) (1.16.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb->guided-diffusion==0.0.0) (4.0.10)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->guided-diffusion==0.0.0) (0.3.0)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->guided-diffusion==0.0.0) (5.3.1)
Requirement already satisfied: rsa<5,>=3.1.4 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth<3,>=1.6.3->tensorboard->guided-diffusion==0.0.0) (4.9)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard->guided-diffusion==0.0.0) (1.3.1)
Requirement already satisfied: idna<4,>=2.5 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.21.0->tensorboard->guided-diffusion==0.0.0) (3.4)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.21.0->tensorboard->guided-diffusion==0.0.0) (3.1.0)
Requirement already satisfied: certifi>=2017.4.17 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests<3,>=2.21.0->tensorboard->guided-diffusion==0.0.0) (2022.12.7)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from werkzeug>=1.0.1->tensorboard->guided-diffusion==0.0.0) (2.1.3)
Requirement already satisfied: fsspec in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from huggingface-hub->timm->guided-diffusion==0.0.0) (2023.1.0)
Requirement already satisfied: packaging>=20.9 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from huggingface-hub->timm->guided-diffusion==0.0.0) (23.1)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from torchvision->timm->guided-diffusion==0.0.0) (9.5.0)
Requirement already satisfied: smmap<6,>=3.0.1 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb->guided-diffusion==0.0.0) (5.0.0)
Requirement already satisfied: zipp>=0.5 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from importlib-metadata->Click!=8.0.0,>=7.0->wandb->guided-diffusion==0.0.0) (3.15.0)
Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard->guided-diffusion==0.0.0) (0.5.0)
Requirement already satisfied: oauthlib>=3.0.0 in /home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard->guided-diffusion==0.0.0) (3.2.2)
Installing collected packages: guided-diffusion
  Attempting uninstall: guided-diffusion
    Found existing installation: guided-diffusion 0.0.0
    Uninstalling guided-diffusion-0.0.0:
      Successfully uninstalled guided-diffusion-0.0.0
  Running setup.py develop for guided-diffusion
Successfully installed guided-diffusion-0.0.0
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
RANK and WORLD_SIZE in environ: 1/3
tcp://127.0.0.1:23457
RANK and WORLD_SIZE in environ: 0/3
tcp://127.0.0.1:23457
RANK and WORLD_SIZE in environ: 2/3
tcp://127.0.0.1:23457
dev: cuda	 rank: 1	 worldsize: 3
args {"data_dir": "/data/students/liuzhou/projects/DataSets/lsun_church/church_outdoor_train_lmdb_color_64.npy", "schedule_sampler": "uniform", "lr": 1e-05, "weight_decay": 0.03, "lr_anneal_steps": 0, "batch_size": 2, "microbatch": -1, "ema_rate": "0.9999", "log_interval": 10, "save_interval": 10000, "resume_checkpoint": "", "use_fp16": true, "fp16_scale_growth": 0.001, "beta1": 0.99, "beta2": 0.99, "exp_name": "Test_87-1-lsun_church-vit_b_layer--lr-1e-5-099_099_pred_x0_minsnr5_fp16_GPUS_3-BATCH_PER_GPU_2", "use_wandb": true, "model_name": "vit_base_patch2_32", "drop_rate": 0.0, "attn_drop_rate": 0.0, "drop_path_rate": 0.0, "use_conv_last": false, "depth": 12, "use_shared_rel_pos_bias": false, "warmup_steps": 0, "lr_final": 1e-05, "clip_norm": -1.0, "local_rank": 0, "drop_label_prob": 0.15, "use_rel_pos_bias": false, "in_chans": 512, "use_pretrained_models": true, "split_spaces": 3, "generate_image_size": 64, "pre_model_on_gpu": true, "dataset_name": "lsun_church", "image_size": 64, "num_channels": 128, "num_res_blocks": 2, "num_heads": 4, "num_heads_upsample": -1, "num_head_channels": -1, "attention_resolutions": "16,8", "channel_mult": "", "dropout": 0.0, "class_cond": true, "use_checkpoint": false, "use_scale_shift_norm": true, "resblock_updown": false, "use_new_attention_order": false, "learn_sigma": false, "diffusion_steps": 1000, "noise_schedule": "cosine", "timestep_respacing": "", "use_kl": false, "predict_xstart": true, "rescale_timesteps": false, "rescale_learned_sigmas": false, "mse_loss_weight_type": "min_snr_5"}
Logging to ./exp/guided_diffusion/Test_87-1-lsun_church-vit_b_layer--lr-1e-5-099_099_pred_x0_minsnr5_fp16_GPUS_3-BATCH_PER_GPU_2
dev: cuda	 rank: 2	 worldsize: 3
args {"data_dir": "/data/students/liuzhou/projects/DataSets/lsun_church/church_outdoor_train_lmdb_color_64.npy", "schedule_sampler": "uniform", "lr": 1e-05, "weight_decay": 0.03, "lr_anneal_steps": 0, "batch_size": 2, "microbatch": -1, "ema_rate": "0.9999", "log_interval": 10, "save_interval": 10000, "resume_checkpoint": "", "use_fp16": true, "fp16_scale_growth": 0.001, "beta1": 0.99, "beta2": 0.99, "exp_name": "Test_87-1-lsun_church-vit_b_layer--lr-1e-5-099_099_pred_x0_minsnr5_fp16_GPUS_3-BATCH_PER_GPU_2", "use_wandb": true, "model_name": "vit_base_patch2_32", "drop_rate": 0.0, "attn_drop_rate": 0.0, "drop_path_rate": 0.0, "use_conv_last": false, "depth": 12, "use_shared_rel_pos_bias": false, "warmup_steps": 0, "lr_final": 1e-05, "clip_norm": -1.0, "local_rank": 0, "drop_label_prob": 0.15, "use_rel_pos_bias": false, "in_chans": 512, "use_pretrained_models": true, "split_spaces": 3, "generate_image_size": 64, "pre_model_on_gpu": true, "dataset_name": "lsun_church", "image_size": 64, "num_channels": 128, "num_res_blocks": 2, "num_heads": 4, "num_heads_upsample": -1, "num_head_channels": -1, "attention_resolutions": "16,8", "channel_mult": "", "dropout": 0.0, "class_cond": true, "use_checkpoint": false, "use_scale_shift_norm": true, "resblock_updown": false, "use_new_attention_order": false, "learn_sigma": false, "diffusion_steps": 1000, "noise_schedule": "cosine", "timestep_respacing": "", "use_kl": false, "predict_xstart": true, "rescale_timesteps": false, "rescale_learned_sigmas": false, "mse_loss_weight_type": "min_snr_5"}
WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39285 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39286 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39287 closing signal SIGINT
Error in sys.excepthook:
Traceback (most recent call last):
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/linecache.py", line 47, in getlines
    return updatecache(filename, module_globals)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/tokenize.py", line 449, in open
    encoding, lines = detect_encoding(buffer.readline)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/tokenize.py", line 418, in detect_encoding
    first = read_or_stop()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/tokenize.py", line 376, in read_or_stop
    return readline()
KeyboardInterrupt

Original exception was:
Traceback (most recent call last):
  File "scripts_vit/Train_stage_one.py", line 180, in <module>
    main()
  File "scripts_vit/Train_stage_one.py", line 48, in main
    wandb.login(key='ff39f513528b6118b78086a2b7617aa4105ac171')
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_login.py", line 77, in login
    configured = _login(**kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_login.py", line 288, in _login
    logged_in = wlogin.login()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_login.py", line 140, in login
    self.login_display()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_login.py", line 145, in login_display
    username = self._wl._get_username()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_setup.py", line 194, in _get_username
    self._load_viewer()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/wandb_setup.py", line 216, in _load_viewer
    s.query_with_timeout()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/sdk/lib/server.py", line 35, in query_with_timeout
    viewer_tuple, viewer_thread = async_viewer()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/wandb/util.py", line 1131, in wrapper
    result = q.get(True, timeout)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/threading.py", line 300, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts_vit/Train_stage_one.py", line 180, in <module>
    main()
  File "scripts_vit/Train_stage_one.py", line 79, in main
    models_dic = pre_trained_models(args.image_size,args.dataset_name).Pre_train_Models()
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/Test/model_prep.py", line 38, in Pre_train_Models
    resnet,FE = self._Resnet_Num()
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/Test/model_prep.py", line 87, in _Resnet_Num
    model = perpectual_Encoder_model(image_size=self.image_size,out_space_channels=self.out_space_channels)
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/guided_diffusion/unet.py", line 1270, in __init__
    nn.ConvTranspose2d(ch,self.out_channels*3,8,8),
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 942, in __init__
    True, output_padding, groups, bias, padding_mode, **factory_kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 628, in __init__
    groups, bias, padding_mode, **factory_kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 144, in __init__
    self.reset_parameters()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 150, in reset_parameters
    init.kaiming_uniform_(self.weight, a=math.sqrt(5))
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/init.py", line 412, in kaiming_uniform_
    return tensor.uniform_(-bound, bound)
KeyboardInterrupt
Traceback (most recent call last):
  File "scripts_vit/Train_stage_one.py", line 180, in <module>
    main()
  File "scripts_vit/Train_stage_one.py", line 79, in main
    models_dic = pre_trained_models(args.image_size,args.dataset_name).Pre_train_Models()
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/Test/model_prep.py", line 38, in Pre_train_Models
    resnet,FE = self._Resnet_Num()
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/Test/model_prep.py", line 87, in _Resnet_Num
    model = perpectual_Encoder_model(image_size=self.image_size,out_space_channels=self.out_space_channels)
  File "/data/students/liuzhou/projects/Min-snr-diffusion-2/guided_diffusion/unet.py", line 1270, in __init__
    nn.ConvTranspose2d(ch,self.out_channels*3,8,8),
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 942, in __init__
    True, output_padding, groups, bias, padding_mode, **factory_kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 628, in __init__
    groups, bias, padding_mode, **factory_kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 144, in __init__
    self.reset_parameters()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 150, in reset_parameters
    init.kaiming_uniform_(self.weight, a=math.sqrt(5))
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/nn/init.py", line 412, in kaiming_uniform_
    return tensor.uniform_(-bound, bound)
KeyboardInterrupt
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39285 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39286 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 39287 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 39226 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 716, in run
    self._shutdown(e.sigval)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 39226 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liuzhou/anaconda3/envs/minsnr/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/run.py", line 762, in main
    run(args)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/run.py", line 756, in run
    )(*cmd_args)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 237, in launch_agent
    result = agent.run()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/metrics/api.py", line 129, in wrapper
    result = f(*args, **kwargs)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 721, in run
    self._shutdown()
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/liuzhou/anaconda3/envs/minsnr/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 39226 got signal: 2
